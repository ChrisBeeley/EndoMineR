<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EndoMineR • EndoMineR</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">EndoMineR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/EndoMineR.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Analysis.html">Analysis</a>
    </li>
    <li>
      <a href="../articles/Barretts.html">Barrett's Oesophagus</a>
    </li>
    <li>
      <a href="../articles/EndoMineRPrinciples.html">EndoMinerPrinciples</a>
    </li>
    <li>
      <a href="../articles/Surveillance.html">Surveillance</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>EndoMineR</h1>
                        <h4 class="author">Sebastian Zeki 2017-12-22</h4>
            
          </div>

    
    
<div class="contents">
<div id="aims-of-endominer" class="section level2">
<h2 class="hasAnchor">
<a href="#aims-of-endominer" class="anchor"></a>Aims of EndoMineR</h2>
<p>The goal of EndoMineR is to extract as much information as possible from endoscopy reports and their associated pathology specimens.</p>
<p>Gastroenterology now has many standards against which practice is measured although many reporting systems do not include the reporting capability to give anything more than basic analysis. Much of the data is locked in semi-structured text. However the nature of semi-structured text means that data can be extracted in a standardised way- it just requires more manipulation. This package provides that manipulation so that complex endoscopic-pathological analyses, in line with recognised standards for these analyses, can be done.</p>
</div>
<div id="how-is-the-package-divided" class="section level2">
<h2 class="hasAnchor">
<a href="#how-is-the-package-divided" class="anchor"></a>How is the package divided?</h2>
<div class="figure">
<img src="EndoMineR_FunctionStructure.svg" alt="Figure 2: Overview of all the functions" width="900"><p class="caption">Figure 2: Overview of all the functions</p>
</div>
<p>The package is basically in three parts. How all the functions are connected in Figure 2. Extracts from this figure will be used in sequential sections below.</p>
<ol style="list-style-type: decimal">
<li><p><strong>The extraction</strong>- This is really when the data is provided as full text reports. You may already have the data in a spreadsheet in which case this part isn’t necessary</p></li>
<li><p><strong>Cleaning</strong>- These are a group of functions that allow the user to extract and clean data commonly found in endoscopic and pathology reports. The cleaning functions usually remove common typos or extraneous information and do some reformatting</p></li>
<li><p><strong>Analyses</strong>- The analyses provide graphing function as well as analyses according to the cornerstone questions in gastroenterology- namely surveillance, patient tracking, quality of endoscopy and pathology reporting and diagnostic yield questions.</p></li>
</ol>
</div>
<div id="the-extractor-function" class="section level2">
<h2 class="hasAnchor">
<a href="#the-extractor-function" class="anchor"></a>The extractor function</h2>
<p>Endoscopic and pathological data will come in one of two forms- either as a collection of the whole text report or as spreadsheets with some degree of separation into different columns of the various aspects of that report eg who the Endoscopist was, the patient’s unique identifier etc. For the latter, the package user will not need to Extract information as it is already extracted and so can go straight to cleaning the data. For the former the Extractor function has been provided:</p>
<p><br></p>
<div class="figure">
<img src="EndoMineR_Extractor.svg" alt="Figure 3: Extractor function"><p class="caption">Figure 3: Extractor function</p>
</div>
<p><br></p>
<p>One of the most useful functions in the package is the Extractor. Different hospitals will use different software with different headings for endoscopic reports. The extractor allows the user to define the separations in a report so that all reports can be automatically placed into a meaningful dataframe for further cleaning. This is analogous to tokenization in natural language processing. Here we use the in built datasets as part of the package. Prior to tokenization it is recommended to use the ChopperNewLine function to divide the free text up by sentence (this can be useful if not using multiline regex or you have another way of splitting the text rather than using the Extractor)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v&lt;-<span class="kw"><a href="../reference/ChopperNewLines.html">ChopperNewLines</a></span>(Myendo,<span class="st">'OGDReportWhole'</span>)</code></pre></div>
<p><br></p>
<p>A list of keywords is then constructed. This list is made up of the words that will be used to split the document. The Extractor then does the splitting for each pair of words, with some cleaning up and then returns the split dataframe:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Mypath&lt;-<span class="kw">data</span>(PathDataFrameFinalColon)
HistolTree&lt;-<span class="kw">list</span>(<span class="st">"Hospital Number"</span>,<span class="st">"Patient Name"</span>,<span class="st">"DOB:"</span>,<span class="st">"General Practitioner:"</span>,
<span class="st">"Date of procedure:"</span>,<span class="st">"Clinical Details:"</span>,<span class="st">"Macroscopic description:"</span>,<span class="st">"Histology:"</span>,<span class="st">"Diagnosis:"</span>,<span class="st">""</span>)
for(i in <span class="dv">1</span>:(<span class="kw">length</span>(HistolTree)-<span class="dv">1</span>)) {
Mypath&lt;-<span class="kw">Extractor</span>(Mypath,<span class="st">"PathReportWhole"</span>,<span class="kw">as.character</span>(HistolTree[i]),
<span class="kw">as.character</span>(HistolTree[i<span class="dv">+1</span>]),<span class="kw">as.character</span>(HistolTree[i]))
}</code></pre></div>
</div>
<div id="the-cleaning-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#the-cleaning-functions" class="anchor"></a>The cleaning functions</h2>
<div id="endoscopic-cleaning" class="section level3">
<h3 class="hasAnchor">
<a href="#endoscopic-cleaning" class="anchor"></a>Endoscopic cleaning</h3>
<p>Once the extraction has been done there are various cleaning functions provided based around the extraction of likely columns. For example if the Endoscopist name has been pulled out, the EndoscChopperEndoscopist function can be used which returns the submitted data frame with the Endoscopist column cleaned up</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/EndoscChopperEndoscopist.html">EndoscChopperEndoscopist</a></span>(Myendo,<span class="st">'Endoscopist'</span>)</code></pre></div>
<p>This function performs the cleaning of common things found in the text that may cause confusion.</p>
<p><br></p>
<div class="figure">
<img src="EndoMineR_EndoscopyClean.svg" alt="Figure 4: Endoscopy Cleaning functions"><p class="caption">Figure 4: Endoscopy Cleaning functions</p>
</div>
<p><br></p>
<p>The EndoscChopperMeds currently extracts Fentanyl and Midazolam doses into a separate column and reformats them as numeric columns so further calculations can be done. In future iterations pethidine, propofol and general anaesthetic will also be able to be extracted.</p>
<p>Several other similar clean up functions are available for Endoscopy as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v&lt;-<span class="kw"><a href="../reference/EndoscChopperMeds.html">EndoscChopperMeds</a></span>(Myendo,<span class="st">'Medications'</span>)
v&lt;-<span class="kw"><a href="../reference/EndoscChopperInstrument.html">EndoscChopperInstrument</a></span>(Myendo,<span class="st">'Instrument'</span>)
v&lt;-<span class="kw"><a href="../reference/EndoscChopperIndications.html">EndoscChopperIndications</a></span>(Myendo,<span class="st">'Indications'</span>)
v&lt;-<span class="kw"><a href="../reference/EndoscChopperProcPerformed.html">EndoscChopperProcPerformed</a></span>(Myendo,<span class="st">'ProcedurePerformed'</span>)</code></pre></div>
<p>Future iterations will try to make these cleaning functions more generic and applicable to a wider number of use cases</p>
</div>
<div id="histological-cleaning" class="section level3">
<h3 class="hasAnchor">
<a href="#histological-cleaning" class="anchor"></a>Histological cleaning</h3>
<p>The cleaning functions for histology are a little more difficult as Histology reports often have a greater degree of free text reporting. In general, each histology reports can be divided into the Macroscopic description of a specimen which itself is comprised of how many specimens there are for each sample sent (a sample can be a pot which includes several specimens) and how big each specimen is. The report will often give a detailed description of what is actually seen and then provide an overall diagnosis.</p>
<p><br></p>
<div class="figure">
<img src="EndoMineR_HistopExtrapol.svg" alt="Figure 5: Histopathology Cleaning functions"><p class="caption">Figure 5: Histopathology Cleaning functions</p>
</div>
<p><br></p>
<p>The histology cleaning functions are based around this. For example, the HistolChopperHistol cleans the Histology text if present. In addition it removes Negative diagnoses using the Negativeremove function. This function is designed to remove all sentences that give negative diagnoses (eg “There is no evidence of…”) so that false positive diagnoses are not made during the analysis stage.</p>
<p>This NegativeRemove function has also been applied to the HistolChopperDx</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t&lt;-<span class="kw"><a href="../reference/HistolChopperHistol.html">HistolChopperHistol</a></span>(Mypath,<span class="st">'Histology'</span>)</code></pre></div>
<p>Because the information from the Macroscopic Description is based around numbers, a further function has been provided to extract numbers from the text. This function is usually only used as part of HistolChopperNumOfBx which extracts the number of biopsies taken.</p>
<p>In order to extract the numbers, the limit of what has to be extracted has to be set as part of the regex so that the function takes whatever word limits the selection.It collects everything from the regex [0-9]{1,2}.{0,3} to whatever the string boundary is.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v&lt;-<span class="kw"><a href="../reference/HistolChopperNumbOfBx.html">HistolChopperNumbOfBx</a></span>(Mypath,<span class="st">'Macroscopicdescription'</span>,<span class="st">'specimen'</span>)</code></pre></div>
<p>Other less useful functions include:</p>
<ol style="list-style-type: decimal">
<li><p>HistolChopperAccessionNumber which extracts Accession Number data from the report where one is present.The Accession number relates to the actual specimen number as ascribed by the pathology service.</p></li>
<li><p>HistolChopperExtrapolDx which extracts other specific diagnoses from the report. These have been hard coded to look for dysplasia cancer and GIST.</p></li>
<li><p>HistolChopperMacDescripCleanup. This extracts Macroscopic description data from the pathology report.Macroscopic description usually relates to the number of specimens retrieved, the size of each specimen and the location it was taken from. The cleanup usually relates to the removal of top and tail characters such as who reported the specimens etc.</p></li>
</ol>
<p>These are all called in the same way:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">v&lt;-<span class="kw"><a href="../reference/HistolChopperMacDescripCleanup.html">HistolChopperMacDescripCleanup</a></span>(Mypath,<span class="st">"Macroscopicdescription"</span>)
v&lt;-<span class="kw"><a href="../reference/HistolChopperExtrapolDx.html">HistolChopperExtrapolDx</a></span>(Mypath,<span class="st">"Diagnosis"</span>)
v&lt;-<span class="kw"><a href="../reference/HistolChopperAccessionNumber.html">HistolChopperAccessionNumber</a></span>(Mypath,<span class="st">"Histology"</span>,<span class="st">"SP-</span><span class="ch">\\</span><span class="st">d{2}-</span><span class="ch">\\</span><span class="st">d{7}"</span>)</code></pre></div>
<p>v&lt;-HistolChopperMacDescripCleanup(Mypath,“Macroscopicdescription”)</p>
<p><br><br></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#aims-of-endominer">Aims of EndoMineR</a></li>
      <li><a href="#how-is-the-package-divided">How is the package divided?</a></li>
      <li><a href="#the-extractor-function">The extractor function</a></li>
      <li><a href="#the-cleaning-functions">The cleaning functions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Sebastian Zeki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
